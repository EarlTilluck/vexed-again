"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[5879],{5879:(y,v,n)=>{n.r(v),n.d(v,{TabsPageModule:()=>e});var r=n(9475),c=n(9808),d=n(2382),b=n(5638),o=n(1223),m=n(3405),f=n(9846);const h=[{path:"",component:(()=>{class t{constructor(i,a,l){this.menu=i,this.game=a,this.ui=l}onMenuToggle(){""===this.ui.blockFor&&this.menu.toggle("side-menu")}onUndo(){this.game.undo()}onReset(){this.game.reset()}}return t.\u0275fac=function(i){return new(i||t)(o.Y36(r._q),o.Y36(m.h),o.Y36(f.F))},t.\u0275cmp=o.Xpm({type:t,selectors:[["app-tabs"]],decls:14,vars:0,consts:[["slot","bottom"],[3,"click"],["name","menu"],["name","arrow-undo"],["name","refresh"]],template:function(i,a){1&i&&(o.TgZ(0,"ion-tabs")(1,"ion-tab-bar",0)(2,"ion-tab-button",1),o.NdJ("click",function(){return a.onMenuToggle()}),o._UZ(3,"ion-icon",2),o.TgZ(4,"ion-label"),o._uU(5,"Menu"),o.qZA()(),o.TgZ(6,"ion-tab-button",1),o.NdJ("click",function(){return a.onUndo()}),o._UZ(7,"ion-icon",3),o.TgZ(8,"ion-label"),o._uU(9,"undo"),o.qZA()(),o.TgZ(10,"ion-tab-button",1),o.NdJ("click",function(){return a.onReset()}),o._UZ(11,"ion-icon",4),o.TgZ(12,"ion-label"),o._uU(13,"reset"),o.qZA()()()())},directives:[r.UN,r.yq,r.ZU,r.gu,r.Q$],styles:[""]}),t})(),children:[{path:"",loadChildren:()=>n.e(2343).then(n.bind(n,2343)).then(t=>t.GamePageModule)},{path:"",redirectTo:"/game",pathMatch:"full"}]},{path:"",redirectTo:"/game",pathMatch:"full"}];let u=(()=>{class t{}return t.\u0275fac=function(i){return new(i||t)},t.\u0275mod=o.oAB({type:t}),t.\u0275inj=o.cJS({imports:[[b.Bz.forChild(h)]]}),t})(),e=(()=>{class t{}return t.\u0275fac=function(i){return new(i||t)},t.\u0275mod=o.oAB({type:t}),t.\u0275inj=o.cJS({imports:[[r.Pc,c.ez,d.u5,u]]}),t})()},3405:(y,v,n)=>{n.d(v,{h:()=>p});var r=n(655),c=n(1223);class d{constructor(u,e,t,s,i){switch(this.blockId=u,this.position=t,this.line=e,this.opacity=i,this.type=s,s){case"a":this.movable=!0,this.name="heart";break;case"b":this.movable=!0,this.name="umbrella";break;case"c":this.movable=!0,this.name="dice";break;case"d":this.movable=!0,this.name="diamond";break;case"e":this.movable=!0,this.name="leaf";break;case"f":this.movable=!0,this.name="nutrition";break;case"g":this.movable=!0,this.name="bowling-ball";break;case"h":this.movable=!0,this.name="balloon";break;case"X":case"Y":this.movable=!1,this.name=""}}}var b=n(2901),o=n(9846),m=n(4252),f=n(9475);let p=(()=>{class h{constructor(e,t,s,i){this.vexed=e,this.ui=t,this.sound=s,this.alertController=i,this.moveEvent=new c.vpe,this.blocksPerLine=0,this.totalLines=0,this.history=[],this.blocks=[],this.currentBest="n/a",this.currentPar=0,this.currentMoveTotal=0,this.currentBlock=null,this.moveRepeat=0,this.direction="left"}loadLevel(){this.currentPar=this.vexed.currentLevel.par,this.currentMoveTotal=0;const e=this.vexed.getBest(this.vexed.currentLevelId);this.currentBest=0===e?"n/a":e+"",this.blocks=[],this.history=this.vexed.getHistory();const s=this.vexed.currentLevel.board.split("/");if(this.blocksPerLine=s[0].length,this.totalLines=s.length,null!==this.history&&this.history.length>0)this.blocks=this.cloneBlocks(this.history[0]),this.currentMoveTotal=this.history.length-1;else{let i=0;for(const a of s){let l=0;for(const k of a)this.blocks.push(new d(i+""+l,i,l,k+"",1)),l++;i++}this.history=[],this.pushHistory()}}tryMove(){if(this.moveRepeat<=0)return this.ui.blockFor="",!1;let e=0;e="left"===this.direction?this.currentBlock.position-1:this.currentBlock.position+1;const t=this.getBlock(this.currentBlock.line,e);return null!==t&&t.position>=0&&t.position<this.blocksPerLine&&this.currentBlock.movable&&"Y"===t.type?(this.swapBlock(this.currentBlock,t),this.currentMoveTotal++,setTimeout(()=>{this.fallBlocks()},250),!0):(this.moveRepeat=0,this.ui.blockFor="",!1)}tryFall(e){const s=this.getBlock(e.line+1,e.position);return null!==s&&!0===e.movable&&"Y"===s.type&&(this.swapBlock(e,s),e.blockId===this.currentBlock.blockId&&(this.moveRepeat=0),!0)}fallBlocks(){let e=!1;for(const t of this.blocks)if(e=this.tryFall(t),e)break;e?setTimeout(()=>{this.fallBlocks()},250):this.vanishBlocks()}vanishBlocks(){let e=!1;for(const t of this.blocks){const s=this.getBlock(t.line-1,t.position),i=this.getBlock(t.line+1,t.position),a=this.getBlock(t.line,t.position-1),l=this.getBlock(t.line,t.position+1);null!==s&&s.type===t.type&&!0===s.movable&&(t.opacity=0,s.opacity=0,e=!0),null!==i&&i.type===t.type&&!0===i.movable&&(t.opacity=0,i.opacity=0,e=!0),null!==a&&a.type===t.type&&!0===a.movable&&(t.opacity=0,a.opacity=0,e=!0),null!==l&&l.type===t.type&&!0===l.movable&&(t.opacity=0,l.opacity=0,e=!0),this.moveEvent.emit(t)}e?(this.sound.playSound("vanish"),setTimeout(()=>{this.checkWin()?this.win():this.fallBlocks()},500)):(this.pushHistory(),this.moveRepeat--,this.tryMove())}swapBlock(e,t){const s=e.line,i=e.position;e.line=t.line,e.position=t.position,t.line=s,t.position=i,this.moveEvent.emit(e),this.moveEvent.emit(t),this.sound.playSound("swish")}checkWin(){let e=!0;for(const t of this.blocks)if(!0===t.movable){e=!1;break}return e}win(){this.history=[],this.vexed.saveHistory(this.history),this.vexed.passLevel(),this.vexed.setBest(this.currentMoveTotal),!1===this.vexed.loadNextLevel()?(this.sound.playSound("winGamePack"),this.presentWinAlert()):this.sound.playSound("passLevel"),this.ui.blockFor=""}getBlock(e,t){let s=null;for(const i of this.blocks)i.position===t&&i.line===e&&(s=i);return s}undo(){this.history.length>1&&(this.blocks=[],this.history.shift(),this.blocks=this.cloneBlocks(this.history[0]),this.vexed.saveHistory(this.history),this.currentMoveTotal--,this.ui.blockFor="")}reset(){for(;this.history.length>1;)this.history.shift();this.blocks=[],this.blocks=this.cloneBlocks(this.history[0]),this.vexed.saveHistory(this.history),this.currentMoveTotal=0,this.ui.blockFor=""}pushHistory(){this.history.unshift(this.cloneBlocks(this.blocks)),this.vexed.saveHistory(this.history)}cloneBlocks(e){const t=[];for(const s of e){const i=new d(s.blockId,s.line,s.position,s.type,s.opacity);t.push(i)}return t}presentWinAlert(){return(0,r.mG)(this,void 0,void 0,function*(){yield(yield this.alertController.create({header:"Congratulations",subHeader:this.vexed.currentPack.name+" has been completed.",message:"Select a new game from the menu",buttons:[{text:"Okay",role:"cancel",id:"cancel-button",handler:()=>{this.vexed.loadLevel(this.vexed.currentLevelId)}}]})).present()})}}return h.\u0275fac=function(e){return new(e||h)(c.LFG(b.X),c.LFG(o.F),c.LFG(m.y),c.LFG(f.Br))},h.\u0275prov=c.Yz7({token:h,factory:h.\u0275fac,providedIn:"root"}),h})()}}]);